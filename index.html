<!-- Keep the rest of your page as-is. Only the form and submit script matter. -->

<!-- Slide-in Waitlist Panel (updated form) -->
<aside id="panel" class="panel" role="dialog" aria-modal="true" aria-label="Join the waitlist">
  <button id="closePanel" class="close" type="button" aria-label="Close">âœ•</button>
  <h2>Join the waitlist</h2>
  <p class="note">Get exclusive discounts. No spam ever.</p>

  <form id="waitlist-form" novalidate>
    <input id="fname" name="fname" type="text" placeholder="First name" required aria-label="First name">
    <input id="lname" name="lname" type="text" placeholder="Last name" required aria-label="Last name">
    <input id="email" name="email" type="email" placeholder="you@example.com" required aria-label="Email address">
    <input id="referral" name="referral" type="text" placeholder="Referral code (optional)" aria-label="Referral code">
    <button class="submit" type="submit">Sign up</button>
    <div id="msg" role="status" aria-live="polite"></div>
  </form>
</aside>

<script>
  // Your existing open/close panel code can stay as-is

  // ðŸ”— Your Google Apps Script Web App URL (must end with /exec)
  const ENDPOINT = "https://script.google.com/macros/s/AKfycbxco5lGJqmNS_wAn5TllmK2aa0PDlGmI-yIR176se9bsAbZIgtIceky-70PfMX9Rpa0jg/exec";

  const form       = document.getElementById('waitlist-form');
  const msg        = document.getElementById('msg');
  const emailInput = document.getElementById('email');

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();

    if (!emailInput.checkValidity()
        || !document.getElementById('fname').value.trim()
        || !document.getElementById('lname').value.trim()) {
      msg.textContent = "Please fill in first name, last name, and a valid email.";
      return;
    }

    const fname    = document.getElementById('fname').value.trim();
    const lname    = document.getElementById('lname').value.trim();
    const email    = emailInput.value.trim();
    const referral = document.getElementById('referral').value.trim();

    const body = new URLSearchParams({ fname, lname, email, referral });

    try {
      const res = await fetch(ENDPOINT, {
        method:'POST',
        headers:{ 'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8' },
        body
      });

      if (res.ok) {
        form.reset();
        msg.textContent = "You're in! Check your inbox for your code.";
      } else {
        msg.textContent = "Submitted. If you donâ€™t get an email, try again in a minute.";
        console.warn('Submit response:', res.status, await res.text().catch(()=> ''));
      }
    } catch (err) {
      msg.textContent = "Network error. Check endpoint & permissions.";
      console.error(err);
    }
  });
</script>

